{"ast":null,"code":"import _slicedToArray from \"@babel/runtime/helpers/slicedToArray\";\nimport _asyncToGenerator from \"@babel/runtime/helpers/asyncToGenerator\";\nimport axios from \"axios\";\nimport { login } from \"../actions/auth\";\nimport { useCookies } from 'react-cookie';\nimport globalconst from \"../constant/globalvariables\";\nvar logIn = function () {\n  var _ref = _asyncToGenerator(function* (values) {\n    var errorMsg = null;\n    var endpoint = 'api/auth/';\n    var payload = {\n      username: values['username'],\n      password: values['password']\n    };\n    axios.defaults.baseURL = globalconst.apiBaseUrl;\n    axios.defaults.headers.post['Content-Type'] = 'application/x-www-form-urlencoded';\n    var rememberMe = values['rememberMe'];\n    return axios({\n      method: 'post',\n      url: endpoint,\n      data: payload\n    }).then(function (response) {\n      var _response$data = response.data,\n        token = _response$data.token,\n        user = _response$data.user;\n      axios.defaults.headers.common.Authorization = `Token ${token}`;\n      var lan = user.language.split(',');\n      user.languages = [];\n      for (var i = 0; i < lan.length; i++) {\n        var newLan = {};\n        var newKey = lan[i];\n        if (lan[i] == \"bengali\") newKey = \"bangla\";\n        newLan.key = newKey;\n        newLan.item = newKey.charAt(0).toUpperCase() + newKey.substr(1).toLowerCase();\n        user.languages.push(newLan);\n      }\n      return response;\n    }).catch(function (error) {\n      if (error.response.data.non_field_errors != null) {\n        alert(\"API call fails with error:\" + error.response.data.non_field_errors);\n        console.log(error.response.data.non_field_errors);\n      } else {\n        alert(\"API call fails with error:\" + error);\n        console.log(error);\n      }\n      return error;\n    });\n  });\n  return function logIn(_x) {\n    return _ref.apply(this, arguments);\n  };\n}();\nvar logOut = function () {\n  var _ref2 = _asyncToGenerator(function* () {\n    return {\n      status: \"success\",\n      message: \"You are logged out\"\n    };\n  });\n  return function logOut() {\n    return _ref2.apply(this, arguments);\n  };\n}();\nvar onLoad = function () {\n  var _ref3 = _asyncToGenerator(function* () {\n    var _useCookies = useCookies(['bhaashadan']),\n      _useCookies2 = _slicedToArray(_useCookies, 2),\n      cookies = _useCookies2[0],\n      setCookie = _useCookies2[1];\n    alert(\"authservice called\" + JSON.stringify(cookies));\n    if (cookies && cookies.bhaashadan && cookies.bhaashadan.token) axios.defaults.headers.common.Authorization = cookies.bhaashadan.token;\n    return cookies;\n  });\n  return function onLoad() {\n    return _ref3.apply(this, arguments);\n  };\n}();\nexport default {\n  logIn: logIn,\n  logOut: logOut,\n  onLoad: onLoad\n};","map":{"version":3,"names":["axios","login","useCookies","globalconst","logIn","_ref","_asyncToGenerator","values","errorMsg","endpoint","payload","username","password","defaults","baseURL","apiBaseUrl","headers","post","rememberMe","method","url","data","then","response","_response$data","token","user","common","Authorization","lan","language","split","languages","i","length","newLan","newKey","key","item","charAt","toUpperCase","substr","toLowerCase","push","catch","error","non_field_errors","alert","console","log","_x","apply","arguments","logOut","_ref2","status","message","onLoad","_ref3","_useCookies","_useCookies2","_slicedToArray","cookies","setCookie","JSON","stringify","bhaashadan"],"sources":["C:/Users/vinee/Desktop/BhaashadanWithUserManagement/Bhaashadan/src/services/authService.js"],"sourcesContent":["//import AsyncStorage from \"@react-native-async-storage/async-storage\";\r\nimport axios from \"axios\";\r\nimport { login } from \"../actions/auth\";\r\nimport { useCookies } from 'react-cookie';\r\nimport globalconst from \"../constant/globalvariables\";\r\n    //alert(\"input username=\"+values['username']);\r\n    \t// let self=props;\r\n         // alert(error.response.status);\r\n                    //    console.log(\"response aauthservice \"+response);\r\n      //  Promise.resolve(response);\r\n     // response.data.status=response.status;\r\n     //alert(values['username']);\r\n  //alert(values['password']);\r\n  //alert(values['rememberMe']);\r\n  //alert(endpoint);\r\n  //alert(\"username:\" +values['username']+\"password:\"+ values['password']);\r\n  //alert(\" rememberMe\"+rememberMe);\r\n  //alert(\"output username=\"+user.first_name);\r\nconst logIn = async (values) => {\r\n  var errorMsg=null;\r\n  const endpoint ='api/auth/';\r\n  const payload = { username: values['username'], password: values['password'] } ;\r\n  axios.defaults.baseURL = globalconst.apiBaseUrl;\r\n  axios.defaults.headers.post['Content-Type'] ='application/x-www-form-urlencoded';\r\n  const rememberMe=values['rememberMe'];\r\n    return axios({\r\n        method: 'post',\r\n        url: endpoint,\r\n        data: payload\r\n      })  \r\n      .then(function (response) { \r\n        const { token,user} = response.data;\r\n        axios.defaults.headers.common.Authorization = `Token ${token}`;\r\n\t\t    const lan = user.language.split(',');\r\n          user.languages=[];\r\n          for(var i=0;i<lan.length;i++){\r\n            var newLan={};\r\n            var newKey=lan[i];\r\n            if(lan[i]==\"bengali\")\r\n            newKey=\"bangla\"\r\n            newLan.key=newKey;\r\n            newLan.item=newKey.charAt(0).toUpperCase() + newKey.substr(1).toLowerCase();\r\n            user.languages.push(newLan);\r\n          }\r\n       return response;\r\n    })\r\n      .catch(function (error) {\r\n        if(error.response.data.non_field_errors!=null)\r\n        {\r\n        alert(\"API call fails with error:\"+error.response.data.non_field_errors);\r\n        console.log(error.response.data.non_field_errors);\r\n        }\r\n        else{\r\n        alert(\"API call fails with error:\"+error);\r\n        console.log(error);\r\n        }\r\n        return error;\r\n        \r\n      });\r\n      \r\n}\r\nconst logOut = async () => {\r\n  \r\n  return {\r\n    status: \"success\",\r\n    message: \"You are logged out\",\r\n  };\r\n};\r\n\r\nconst onLoad = async () => {\r\n  const [cookies, setCookie] = useCookies(['bhaashadan']);\r\n  alert(\"authservice called\"+JSON.stringify(cookies));\r\n  if(cookies && cookies.bhaashadan && cookies.bhaashadan.token)\r\n  axios.defaults.headers.common.Authorization=cookies.bhaashadan.token;\r\n  return cookies;\r\n\r\n};\r\n\r\nexport default {\r\n  logIn,\r\n  logOut,\r\n  onLoad,\r\n};"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}